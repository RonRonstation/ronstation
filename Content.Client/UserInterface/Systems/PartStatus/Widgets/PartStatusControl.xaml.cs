using System.Linq;
using Content.Shared.Targeting;
using Robust.Client.AutoGenerated;
using Robust.Client.Graphics;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.UserInterface.Systems.PartStatus.Widgets;

[GenerateTypedNameReferences]
public sealed partial class PartStatusControl : UIWidget
{
    private readonly PartStatusUIController _controller;
    private readonly Dictionary<TargetBodyPart, TextureRect> _partStatusControls;

    public PartStatusControl()
    {
        RobustXamlLoader.Load(this);
        _controller = UserInterfaceManager.GetUIController<PartStatusUIController>();

        _partStatusControls = new Dictionary<TargetBodyPart, TextureRect>
        {
            { TargetBodyPart.Head, DollHead },
            { TargetBodyPart.Torso, DollTorso },
            { TargetBodyPart.LeftArm, DollLeftArm },
            { TargetBodyPart.RightArm, DollRightArm },
            { TargetBodyPart.LeftLeg, DollLeftLeg },
            { TargetBodyPart.RightLeg, DollRightLeg }
        };
    }

    public void SetIntegrity(TargetBodyPart bodyPart, float integrity)
    {
        _partStatusControls[bodyPart].Texture = _controller.GetPartStatusTexture(bodyPart, integrity);
    }

    public void SetVisible(bool visible)
    {
        this.Visible = visible;
    }
}